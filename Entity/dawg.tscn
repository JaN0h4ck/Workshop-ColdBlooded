[gd_scene load_steps=25 format=3 uid="uid://biyepj0wc6lid"]

[ext_resource type="Texture2D" uid="uid://c5v52yx7dpet8" path="res://Entity/Dawg/tile_0002.png" id="1_2gfny"]
[ext_resource type="Script" path="res://Entity/Scripts/Agent.gd" id="1_ovl54"]
[ext_resource type="Texture2D" uid="uid://bb8e3reqwvian" path="res://Entity/Dawg/tile_0003.png" id="2_1s38v"]
[ext_resource type="Script" path="res://Entity/ResourceEntity.gd" id="2_dh287"]
[ext_resource type="Script" path="res://Entity/Scripts/hitbox.gd" id="5_0h4rt"]
[ext_resource type="Script" path="res://ai/tasks/select_patrol_pos.gd" id="5_uv7ph"]
[ext_resource type="Script" path="res://ai/tasks/move.gd" id="6_1r1mm"]
[ext_resource type="Script" path="res://ai/tasks/select_random_nearby_pos.gd" id="6_grgrg"]
[ext_resource type="Script" path="res://Entity/Scripts/hurtbox.gd" id="6_hbkb7"]

[sub_resource type="Resource" id="Resource_1kyr4"]
script = ExtResource("2_dh287")
health = 10
attack_damage = 5

[sub_resource type="SpriteFrames" id="SpriteFrames_unvjb"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("1_2gfny")
}, {
"duration": 1.0,
"texture": ExtResource("2_1s38v")
}],
"loop": true,
"name": &"walk",
"speed": 5.0
}]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_jkquf"]
size = Vector2(20, 22)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_w4opf"]
size = Vector2(20, 22)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_v8jcb"]
size = Vector2(20, 22)

[sub_resource type="BlackboardPlan" id="BlackboardPlan_nl4sc"]
var/speed/name = &"speed"
var/speed/type = 3
var/speed/value = 0.0
var/speed/hint = 1
var/speed/hint_string = "10,1000,10"

[sub_resource type="BTWait" id="BTWait_m3eic"]
duration = 3.0

[sub_resource type="BTAction" id="BTAction_5y1qu"]
script = ExtResource("5_uv7ph")
position_left_relative = 200.0
position_right_relative = 200.0
fallback_steps_px = 18.0
position_var = &"target_pos"

[sub_resource type="BTAction" id="BTAction_yq17s"]
script = ExtResource("6_grgrg")
range_min = -200.0
range_max = 200.0
position_var = &"target_pos"

[sub_resource type="BTSelector" id="BTSelector_cji42"]
children = [SubResource("BTAction_5y1qu"), SubResource("BTAction_yq17s")]

[sub_resource type="BTAction" id="BTAction_rm2ps"]
script = ExtResource("6_1r1mm")
target_position_var = &"target_pos"
speed_var = &"speed"
tolerance = 50.0

[sub_resource type="BTSequence" id="BTSequence_fjdvl"]
custom_name = "Patrol"
children = [SubResource("BTSelector_cji42"), SubResource("BTAction_rm2ps")]

[sub_resource type="BTSequence" id="BTSequence_i7tgf"]
children = [SubResource("BTWait_m3eic"), SubResource("BTSequence_fjdvl")]

[sub_resource type="BehaviorTree" id="BehaviorTree_m8umg"]
blackboard_plan = SubResource("BlackboardPlan_nl4sc")
root_task = SubResource("BTSequence_i7tgf")

[sub_resource type="BlackboardPlan" id="BlackboardPlan_adeud"]
var/speed/name = &"speed"
var/speed/type = 3
var/speed/value = 200.0
var/speed/hint = 1
var/speed/hint_string = "10,1000,10"

[node name="Dawg" type="CharacterBody2D" groups=["damageable"]]
script = ExtResource("1_ovl54")
entity_resource = SubResource("Resource_1kyr4")

[node name="Sprite" type="AnimatedSprite2D" parent="."]
sprite_frames = SubResource("SpriteFrames_unvjb")
animation = &"walk"
frame = 1
frame_progress = 0.322454
flip_h = true

[node name="RayCast2D" type="RayCast2D" parent="Sprite"]
target_position = Vector2(27, 0)

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(0, -1)
shape = SubResource("RectangleShape2D_jkquf")

[node name="Hitbox" type="Area2D" parent="."]
script = ExtResource("5_0h4rt")
entity_resource = SubResource("Resource_1kyr4")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Hitbox"]
position = Vector2(20, -1)
shape = SubResource("RectangleShape2D_w4opf")
disabled = true
debug_color = Color(1, 0, 0, 0.419608)

[node name="Hurtbox" type="Area2D" parent="."]
script = ExtResource("6_hbkb7")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Hurtbox"]
position = Vector2(0, -1)
shape = SubResource("RectangleShape2D_v8jcb")

[node name="BTPlayer" type="BTPlayer" parent="."]
behavior_tree = SubResource("BehaviorTree_m8umg")
blackboard_plan = SubResource("BlackboardPlan_adeud")
